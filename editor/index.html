<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KCDK Config Editor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@json-editor/json-editor@latest/dist/jsoneditor.min.js"></script>
    <style>
        body {
            padding: 15px;
            background-color: #f8f9fa;
            font-size: 14px;
        }

        .container {
            max-width: 1400px;
            background: white;
            padding: 20px;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 24px;
        }

        .text-muted {
            font-size: 13px;
            margin-bottom: 15px;
        }

        #editor_holder {
            margin-bottom: 15px;
        }

        /* ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãªãƒ•ã‚©ãƒ¼ãƒ è¦ç´  */
        .json-editor-container {
            font-size: 13px;
        }

        input[type="text"],
        input[type="number"],
        select {
            padding: 4px 8px !important;
            font-size: 13px !important;
            height: 28px !important;
        }

        .form-control {
            padding: 4px 8px !important;
            font-size: 13px !important;
        }

        label {
            font-size: 13px !important;
            margin-bottom: 3px !important;
            font-weight: 500;
        }

        .form-group {
            margin-bottom: 10px !important;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã« */
        h3,
        h4,
        h5 {
            font-size: 15px !important;
            margin: 8px 0 !important;
            font-weight: 600;
        }

        .alert {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 9999;
            min-width: 250px;
            font-size: 13px;
        }

        .footer-buttons {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            position: sticky;
            bottom: 0;
            background: white;
            padding: 10px 0;
            border-top: 1px solid #dee2e6;
        }

        .footer-buttons button {
            flex: 1;
            padding: 10px 15px !important;
            font-size: 14px !important;
        }

        /* ãƒœã‚¿ãƒ³å…¨èˆ¬ã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã« */
        button,
        .btn {
            padding: 4px 10px !important;
            font-size: 13px !important;
            line-height: 1.4;
        }

        /* é…åˆ—æ“ä½œãƒœã‚¿ãƒ³ */
        .json-editor-btn-add,
        .json-editor-btn-delete,
        .json-editor-btn-moveup,
        .json-editor-btn-movedown {
            padding: 3px 8px !important;
            font-size: 12px !important;
            margin: 0 2px;
        }

        /* é…åˆ—ã®æœ€å¾Œã®è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º */
        .json-editor-btntype-deletelast {
            display: none !important;
        }

        /* nullè¨±å®¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ«æ”¹å–„ */
        .json-editor-btntype-delete {
            background-color: #dc3545 !important;
            border-color: #dc3545 !important;
            color: white !important;
        }

        .json-editor-btntype-add {
            background-color: #28a745 !important;
            border-color: #28a745 !important;
            color: white !important;
        }

        /* nullãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®è¡¨ç¤ºã‚’æ”¹å–„ */
        .json-editor-btn-delete::before {
            content: "âŒ ";
        }

        .json-editor-btn-add::before {
            content: "â• ";
        }

        /* ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã®é–‹é–‰ãƒœã‚¿ãƒ³ã‚’çŸ¢å°ã«å¤‰æ›´ */
        .json-editor-btntype-toggle {
            font-size: 0 !important;
            min-width: 24px !important;
            padding: 4px 8px !important;
        }

        .json-editor-btntype-toggle::before {
            content: "â–¼";
            font-size: 13px;
            display: inline-block;
            transition: transform 0.2s;
        }

        .json-editor-btntype-toggle.collapsed::before {
            content: "â–¶";
        }

        /* ã‚«ãƒ¼ãƒ‰é¢¨ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .card {
            margin-bottom: 10px !important;
        }

        .card-body {
            padding: 12px !important;
        }

        /* é…åˆ—ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .row {
            margin-bottom: 8px !important;
        }

        /* ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤ºã‚’æ”¹å–„ */
        .col-md-2,
        .col-md-3,
        .col-md-4,
        .col-md-6 {
            padding-left: 5px !important;
            padding-right: 5px !important;
        }

        /* éšå±¤ã”ã¨ã«èƒŒæ™¯è‰²ã‚’äº¤äº’ã«å¤‰ãˆã‚‹ */
        /* ãƒ¬ãƒ™ãƒ«1: teams, endConditionsé…åˆ—ã®ã‚¢ã‚¤ãƒ†ãƒ  */
        [data-schemapath^="root.teams."],
        [data-schemapath^="root.endConditions."] {
            background-color: #f0f4f8 !important;
            padding: 10px !important;
            margin-bottom: 8px !important;
            border-radius: 4px !important;
        }

        /* ãƒ¬ãƒ™ãƒ«2: roles, effects, conditionsé…åˆ—ã®ã‚¢ã‚¤ãƒ†ãƒ  */
        [data-schemapath*=".roles."],
        [data-schemapath*=".effects."],
        [data-schemapath*=".conditions."] {
            background-color: #e1e8ed !important;
            padding: 8px !important;
            margin-bottom: 6px !important;
            border-radius: 4px !important;
        }

        /* ãƒ¬ãƒ™ãƒ«3ä»¥é™ã¯ã•ã‚‰ã«æ¿ƒã */
        [data-schemapath*=".roles."] [data-schemapath*=".effects."],
        [data-schemapath*=".conditions."] [data-schemapath*=".location"],
        [data-schemapath*=".readyLocation"],
        [data-schemapath*=".respawnLocation"] {
            background-color: #d3dce6 !important;
            padding: 8px !important;
            border-radius: 3px !important;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ® KCDK Configuration Editor</h1>
        <p class="text-muted">Minecraft PvPã‚²ãƒ¼ãƒ è¨­å®šã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ - è¨­å®šã‚’ç·¨é›†ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã§ãã¾ã™</p>

        <div id="editor_holder"></div>

        <div class="footer-buttons">
            <button id="copy-json" class="btn btn-primary btn-lg">
                ğŸ“‹ JSONã‚’ã‚³ãƒ”ãƒ¼
            </button>
            <button id="share-url" class="btn btn-secondary btn-lg">
                ğŸ”— å…±æœ‰URLã‚’ã‚³ãƒ”ãƒ¼
            </button>
            <button id="reset-config" class="btn btn-warning btn-lg">
                ğŸ”„ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™
            </button>
        </div>
    </div>

    <script>
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
        const defaultConfig = {
            "configVersion": 1,
            "gamemode": "adventure",
            "showBossBar": true,
            "timeLimit": {
                "hour": 0,
                "minutes": 10,
                "second": 0
            },
            "teams": [
                {
                    "name": "blue",
                    "displayName": "Â§9é’ãƒãƒ¼ãƒ ",
                    "armorColor": 255,
                    "readyLocation": {
                        "world": "world",
                        "x": 0.0,
                        "y": 64.0,
                        "z": 0.0,
                        "yaw": 0.0,
                        "pitch": 0.0
                    },
                    "respawnLocation": {
                        "world": "world",
                        "x": 0.0,
                        "y": 64.0,
                        "z": 0.0,
                        "yaw": 0.0,
                        "pitch": 0.0
                    },
                    "stock": -1,
                    "waitingTime": {
                        "hour": 0,
                        "minutes": 0,
                        "second": 30
                    },
                    "effects": [],
                    "roles": []
                },
                {
                    "name": "red",
                    "displayName": "Â§cèµ¤ãƒãƒ¼ãƒ ",
                    "armorColor": 16711680,
                    "readyLocation": {
                        "world": "world",
                        "x": 100.0,
                        "y": 64.0,
                        "z": 0.0,
                        "yaw": 180.0,
                        "pitch": 0.0
                    },
                    "respawnLocation": {
                        "world": "world",
                        "x": 100.0,
                        "y": 64.0,
                        "z": 0.0,
                        "yaw": 180.0,
                        "pitch": 0.0
                    },
                    "stock": -1,
                    "waitingTime": {
                        "hour": 0,
                        "minutes": 0,
                        "second": 30
                    },
                    "effects": [],
                    "roles": [
                        {
                            "name": "captain",
                            "displayName": "Â§eå¤§å°†",
                            "armorColor": null,
                            "readyLocation": null,
                            "respawnLocation": {
                                "world": "world",
                                "x": 110.0,
                                "y": 64.0,
                                "z": 0.0,
                                "yaw": 180.0,
                                "pitch": 0.0
                            },
                            "stock": null,
                            "waitingTime": null,
                            "effects": [
                                {
                                    "name": "SPEED",
                                    "second": 999999,
                                    "amplifier": 1,
                                    "hideParticles": false
                                },
                                {
                                    "name": "STRENGTH",
                                    "second": 999999,
                                    "amplifier": 0,
                                    "hideParticles": false
                                }
                            ],
                            "extendsEffects": true,
                            "extendsItem": true
                        }
                    ]
                }
            ],
            "endConditions": [
                {
                    "type": "Beacon",
                    "message": "Â§cãƒ“ãƒ¼ã‚³ãƒ³ãŒç ´å£Šã•ã‚ŒãŸï¼",
                    "location": {
                        "world": "world",
                        "x": 0.0,
                        "y": 64.0,
                        "z": 0.0,
                        "yaw": 0.0,
                        "pitch": 0.0
                    },
                    "hitpoint": 100
                },
                {
                    "type": "Extermination",
                    "message": "Â§4å…¨æ»…ï¼",
                    "team": "blue"
                },
                {
                    "type": "Composite",
                    "message": "Â§6ãƒ“ãƒ¼ã‚³ãƒ³ç ´å£Š & ãƒã‚±ãƒƒãƒˆæ¶ˆè²»ã§å‹åˆ©ï¼",
                    "conditions": [
                        {
                            "type": "Beacon",
                            "message": "",
                            "location": {
                                "world": "world",
                                "x": 100.0,
                                "y": 64.0,
                                "z": 0.0,
                                "yaw": 0.0,
                                "pitch": 0.0
                            },
                            "hitpoint": 50
                        },
                        {
                            "type": "Ticket",
                            "message": "",
                            "team": "red",
                            "count": 30
                        }
                    ]
                }
            ]
        };

        // JSONã‚¹ã‚­ãƒ¼ãƒå®šç¾©
        const schema = {
            "title": "KCDK Configuration",
            "type": "object",
            "required": ["configVersion", "gamemode", "showBossBar", "teams", "endConditions"],
            "properties": {
                "configVersion": {
                    "type": "integer",
                    "title": "Config Version",
                    "default": 1
                },
                "gamemode": {
                    "type": "string",
                    "title": "ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰",
                    "enum": ["survival", "adventure", "creative", "spectator"],
                    "default": "survival"
                },
                "showBossBar": {
                    "type": "boolean",
                    "title": "ãƒœã‚¹ãƒãƒ¼è¡¨ç¤º",
                    "description": "ã‚²ãƒ¼ãƒ ä¸­ã«ãƒœã‚¹ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã‹",
                    "default": true
                },
                "timeLimit": {
                    "title": "æ™‚é–“åˆ¶é™",
                    "type": "object",
                    "description": "nullã®å ´åˆã€æ™‚é–“åˆ¶é™ãªã—ã«ãªã‚Šã¾ã™",
                    "required": ["hour", "gamemode", "minutes", "second"],
                    "properties": {
                        "hour": {
                            "type": "integer",
                            "title": "æ™‚é–“",
                            "default": 0
                        },
                        "minutes": {
                            "type": "integer",
                            "title": "åˆ†",
                            "default": 10
                        },
                        "second": {
                            "type": "integer",
                            "title": "ç§’",
                            "default": 0
                        }
                    }
                },
                "teams": {
                    "type": "array",
                    "title": "ãƒãƒ¼ãƒ ",
                    "items": {
                        "type": "object",
                        "title": "ãƒãƒ¼ãƒ ",
                        "required": ["name", "displayName", "armorColor", "respawnLocation", "stock", "waitingTime", "effects", "roles"],
                        "properties": {
                            "name": {
                                "type": "string",
                                "title": "ãƒãƒ¼ãƒ å"
                            },
                            "displayName": {
                                "type": "string",
                                "title": "è¡¨ç¤ºå"
                            },
                            "armorColor": {
                                "type": "integer",
                                "title": "ã‚¢ãƒ¼ãƒãƒ¼ã‚«ãƒ©ãƒ¼ï¼ˆRGBï¼‰"
                            },
                            "readyLocation": {
                                "title": "å¾…æ©Ÿåœ°ç‚¹",
                                "type": "object",
                                "required": ["world", "x", "y", "z", "yaw", "pitch"],
                                "description": "nullã®å ´åˆã€å¾…æ©Ÿåœ°ç‚¹ãªã—ã§é–‹å§‹æ™‚ã«respawnLocationã¸ç›´æ¥ãƒ†ãƒ¬ãƒãƒ¼ãƒˆã—ã¾ã™",
                                "properties": {
                                    "world": { "type": "string", "title": "ãƒ¯ãƒ¼ãƒ«ãƒ‰" },
                                    "x": { "type": "number", "title": "Xåº§æ¨™" },
                                    "y": { "type": "number", "title": "Yåº§æ¨™" },
                                    "z": { "type": "number", "title": "Zåº§æ¨™" },
                                    "yaw": { "type": "number", "title": "Yaw" },
                                    "pitch": { "type": "number", "title": "Pitch" }
                                }
                            },
                            "respawnLocation": {
                                "type": "object",
                                "title": "ãƒªã‚¹ãƒãƒ¼ãƒ³åœ°ç‚¹ï¼ˆå¿…é ˆï¼‰",
                                "required": ["world", "x", "y", "z", "yaw", "pitch"],
                                "properties": {
                                    "world": { "type": "string", "title": "ãƒ¯ãƒ¼ãƒ«ãƒ‰" },
                                    "x": { "type": "number", "title": "Xåº§æ¨™" },
                                    "y": { "type": "number", "title": "Yåº§æ¨™" },
                                    "z": { "type": "number", "title": "Zåº§æ¨™" },
                                    "yaw": { "type": "number", "title": "Yaw" },
                                    "pitch": { "type": "number", "title": "Pitch" }
                                }
                            },
                            "stock": {
                                "type": "integer",
                                "title": "ãƒªã‚¹ãƒãƒ¼ãƒ³å›æ•°ï¼ˆ-1=ç„¡é™ï¼‰"
                            },
                            "waitingTime": {
                                "type": "object",
                                "title": "å¾…æ©Ÿæ™‚é–“",
                                "required": ["hour", "minutes", "second"],
                                "properties": {
                                    "hour": { "type": "integer", "title": "æ™‚é–“" },
                                    "minutes": { "type": "integer", "title": "åˆ†" },
                                    "second": { "type": "integer", "title": "ç§’" }
                                }
                            },
                            "effects": {
                                "type": "array",
                                "title": "ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ",
                                "items": {
                                    "type": "object",
                                    "title": " ",
                                    "required": ["name", "second", "amplifier", "hideParticles"],
                                    "properties": {
                                        "name": { "type": "string", "title": "ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå" },
                                        "second": { "type": "integer", "title": "æŒç¶šæ™‚é–“ï¼ˆç§’ï¼‰" },
                                        "amplifier": { "type": "integer", "title": "ãƒ¬ãƒ™ãƒ«" },
                                        "hideParticles": { "type": "boolean", "title": "ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«éè¡¨ç¤º" }
                                    }
                                }
                            },
                            "roles": {
                                "type": "array",
                                "title": "ãƒ­ãƒ¼ãƒ«",
                                "items": {
                                    "type": "object",
                                    "title": " ",
                                    "required": ["name", "respawnLocation", "effects", "extendsEffects", "extendsItem"],
                                    "properties": {
                                        "name": { "type": "string", "title": "ãƒ­ãƒ¼ãƒ«å" },
                                        "displayName": {
                                            "type": ["string", "null"],
                                            "title": "è¡¨ç¤ºå",
                                            "description": "nullã®å ´åˆã¯è¦ªãƒãƒ¼ãƒ ã®è¡¨ç¤ºåã‚’ç¶™æ‰¿ã—ã¾ã™"
                                        },
                                        "armorColor": {
                                            "type": ["integer", "null"],
                                            "title": "ã‚¢ãƒ¼ãƒãƒ¼ã‚«ãƒ©ãƒ¼",
                                            "description": "nullã®å ´åˆã¯è¦ªãƒãƒ¼ãƒ ã®ã‚¢ãƒ¼ãƒãƒ¼ã‚«ãƒ©ãƒ¼ã‚’ç¶™æ‰¿ã—ã¾ã™"
                                        },
                                        "readyLocation": {
                                            "type": ["object", "null"],
                                            "title": "å¾…æ©Ÿåœ°ç‚¹",
                                            "description": "nullã®å ´åˆã¯è¦ªãƒãƒ¼ãƒ ã®å¾…æ©Ÿåœ°ç‚¹ã‚’ç¶™æ‰¿ã—ã¾ã™",
                                            "properties": {
                                                "world": { "type": "string", "title": "ãƒ¯ãƒ¼ãƒ«ãƒ‰" },
                                                "x": { "type": "number", "title": "X" },
                                                "y": { "type": "number", "title": "Y" },
                                                "z": { "type": "number", "title": "Z" },
                                                "yaw": { "type": "number", "title": "Yaw" },
                                                "pitch": { "type": "number", "title": "Pitch" }
                                            }
                                        },
                                        "respawnLocation": {
                                            "type": "object",
                                            "title": "ãƒªã‚¹ãƒãƒ¼ãƒ³åœ°ç‚¹ï¼ˆå¿…é ˆï¼‰",
                                            "properties": {
                                                "world": { "type": "string", "title": "ãƒ¯ãƒ¼ãƒ«ãƒ‰" },
                                                "x": { "type": "number", "title": "X" },
                                                "y": { "type": "number", "title": "Y" },
                                                "z": { "type": "number", "title": "Z" },
                                                "yaw": { "type": "number", "title": "Yaw" },
                                                "pitch": { "type": "number", "title": "Pitch" }
                                            }
                                        },
                                        "stock": {
                                            "type": ["integer", "null"],
                                            "title": "ãƒªã‚¹ãƒãƒ¼ãƒ³å›æ•°ï¼ˆ-1=ç„¡é™ï¼‰",
                                            "description": "nullã®å ´åˆã¯è¦ªãƒãƒ¼ãƒ ã®ãƒªã‚¹ãƒãƒ¼ãƒ³å›æ•°ã‚’ç¶™æ‰¿ã—ã¾ã™"
                                        },
                                        "waitingTime": {
                                            "type": ["object", "null"],
                                            "title": "å¾…æ©Ÿæ™‚é–“",
                                            "description": "nullã®å ´åˆã¯è¦ªãƒãƒ¼ãƒ ã®å¾…æ©Ÿæ™‚é–“ã‚’ç¶™æ‰¿ã—ã¾ã™",
                                            "properties": {
                                                "hour": { "type": "integer", "title": "æ™‚é–“" },
                                                "minutes": { "type": "integer", "title": "åˆ†" },
                                                "second": { "type": "integer", "title": "ç§’" }
                                            }
                                        },
                                        "effects": {
                                            "type": "array",
                                            "title": "ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "name": { "type": "string", "title": "ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå" },
                                                    "second": { "type": "integer", "title": "æŒç¶šæ™‚é–“" },
                                                    "amplifier": { "type": "integer", "title": "ãƒ¬ãƒ™ãƒ«" },
                                                    "hideParticles": { "type": "boolean", "title": "ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«éè¡¨ç¤º" }
                                                }
                                            }
                                        },
                                        "extendsEffects": { "type": "boolean", "title": "è¦ªãƒãƒ¼ãƒ ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ç¶™æ‰¿" },
                                        "extendsItem": { "type": "boolean", "title": "è¦ªãƒãƒ¼ãƒ ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’ç¶™æ‰¿" }
                                    }
                                }
                            }
                        }
                    }
                },
                "endConditions": {
                    "type": "array",
                    "title": "çµ‚äº†æ¡ä»¶ï¼ˆORï¼‰",
                    "description": "é…åˆ—å†…ã®æ¡ä»¶ã¯ORï¼ˆã„ãšã‚Œã‹1ã¤é”æˆã§çµ‚äº†ï¼‰",
                    "items": {
                        "type": "object",
                        "title": "çµ‚äº†æ¡ä»¶",
                        "oneOf": [
                            {
                                "title": "Beaconï¼ˆãƒ“ãƒ¼ã‚³ãƒ³ç ´å£Šï¼‰",
                                "required": ["type", "message", "location", "hitpoint"],
                                "properties": {
                                    "type": { "type": "string", "enum": ["Beacon"], "default": "Beacon" },
                                    "message": { "type": "string", "title": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", "default": "Â§cãƒ“ãƒ¼ã‚³ãƒ³ãŒç ´å£Šã•ã‚ŒãŸï¼" },
                                    "location": {
                                        "type": "object",
                                        "title": "åº§æ¨™",
                                        "required": ["world", "x", "y", "z", "yaw", "pitch"],
                                        "properties": {
                                            "world": { "type": "string", "title": "ãƒ¯ãƒ¼ãƒ«ãƒ‰", "default": "world" },
                                            "x": { "type": "number", "title": "X", "default": 0 },
                                            "y": { "type": "number", "title": "Y", "default": 64 },
                                            "z": { "type": "number", "title": "Z", "default": 0 },
                                            "yaw": { "type": "number", "title": "Yaw", "default": 0 },
                                            "pitch": { "type": "number", "title": "Pitch", "default": 0 }
                                        }
                                    },
                                    "hitpoint": { "type": "integer", "title": "HP", "default": 100 }
                                }
                            },
                            {
                                "title": "Exterminationï¼ˆå…¨æ»…ï¼‰",
                                "required": ["type", "message", "team"],
                                "properties": {
                                    "type": { "type": "string", "enum": ["Extermination"], "default": "Extermination" },
                                    "message": { "type": "string", "title": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", "default": "Â§4å…¨æ»…ï¼" },
                                    "team": { "type": "string", "title": "ãƒãƒ¼ãƒ å" }
                                }
                            },
                            {
                                "title": "Ticketï¼ˆãƒã‚±ãƒƒãƒˆï¼‰",
                                "properties": {
                                    "type": { "type": "string", "enum": ["Ticket"], "default": "Ticket" },
                                    "message": { "type": "string", "title": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", "default": "Â§6ãƒã‚±ãƒƒãƒˆãŒå°½ããŸï¼" },
                                    "team": { "type": "string", "title": "ãƒãƒ¼ãƒ å" },
                                    "count": { "type": "integer", "title": "ãƒã‚±ãƒƒãƒˆæ•°", "default": 50 }
                                }
                            },
                            {
                                "title": "Compositeï¼ˆè¤‡åˆæ¡ä»¶ - ANDï¼‰",
                                "description": "è¤‡æ•°ã®æ¡ä»¶ã‚’ã™ã¹ã¦é”æˆã§åˆ¤å®š",
                                "properties": {
                                    "type": { "type": "string", "enum": ["Composite"], "default": "Composite" },
                                    "message": { "type": "string", "title": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", "default": "Â§aæ¡ä»¶é”æˆï¼" },
                                    "conditions": {
                                        "type": "array",
                                        "title": "æ¡ä»¶ãƒªã‚¹ãƒˆ",
                                        "description": "åˆ¤å®šã™ã‚‹æ¡ä»¶ã®ãƒªã‚¹ãƒˆ",
                                        "items": {
                                            "type": "object",
                                            "oneOf": [
                                                {
                                                    "title": "Beacon",
                                                    "properties": {
                                                        "type": { "type": "string", "enum": ["Beacon"], "default": "Beacon" },
                                                        "message": { "type": "string", "title": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", "default": "" },
                                                        "location": {
                                                            "type": "object",
                                                            "title": "åº§æ¨™",
                                                            "properties": {
                                                                "world": { "type": "string", "title": "ãƒ¯ãƒ¼ãƒ«ãƒ‰", "default": "world" },
                                                                "x": { "type": "number", "title": "X", "default": 0 },
                                                                "y": { "type": "number", "title": "Y", "default": 64 },
                                                                "z": { "type": "number", "title": "Z", "default": 0 },
                                                                "yaw": { "type": "number", "title": "Yaw", "default": 0 },
                                                                "pitch": { "type": "number", "title": "Pitch", "default": 0 }
                                                            }
                                                        },
                                                        "hitpoint": { "type": "integer", "title": "HP", "default": 100 }
                                                    }
                                                },
                                                {
                                                    "title": "Extermination",
                                                    "properties": {
                                                        "type": { "type": "string", "enum": ["Extermination"], "default": "Extermination" },
                                                        "message": { "type": "string", "title": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", "default": "" },
                                                        "team": { "type": "string", "title": "ãƒãƒ¼ãƒ å" }
                                                    }
                                                },
                                                {
                                                    "title": "Ticket",
                                                    "properties": {
                                                        "type": { "type": "string", "enum": ["Ticket"], "default": "Ticket" },
                                                        "message": { "type": "string", "title": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", "default": "" },
                                                        "team": { "type": "string", "title": "ãƒãƒ¼ãƒ å" },
                                                        "count": { "type": "integer", "title": "ãƒã‚±ãƒƒãƒˆæ•°", "default": 50 }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            }
                        ]
                    }
                }
            }
        };

        // URLã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰è¨­å®šã‚’å–å¾—
        function getConfigFromURL() {
            const params = new URLSearchParams(window.location.search);
            const configParam = params.get('config');

            if (configParam) {
                try {
                    return JSON.parse(decodeURIComponent(configParam));
                } catch (e) {
                    console.error('Failed to parse config from URL:', e);
                    showAlert('URLã‹ã‚‰ã®è¨­å®šèª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ', 'danger');
                }
            }

            return defaultConfig;
        }

        // ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼åˆæœŸåŒ–
        const initialConfig = getConfigFromURL();
        const editor = new JSONEditor(document.getElementById('editor_holder'), {
            schema: schema,
            theme: 'bootstrap5',
            iconlib: 'fontawesome5',
            disable_collapse: false,
            disable_edit_json: true,
            disable_properties: true,
            startval: initialConfig,
            // nullè¨±å®¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®è¨­å®š
            show_opt_in: true,
            // nullå€¤ã‚’æŒã¤ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å‰Šé™¤ãƒœã‚¿ãƒ³ã§åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ã«
            no_additional_properties: false,
            // ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãªè¡¨ç¤º
            object_layout: 'normal'
        });

        // ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º
        function showAlert(message, type = 'success') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.body.appendChild(alertDiv);

            setTimeout(() => {
                alertDiv.remove();
            }, 3000);
        }

        // JSONã‚³ãƒ”ãƒ¼
        document.getElementById('copy-json').addEventListener('click', () => {
            const config = editor.getValue();
            const json = JSON.stringify(config);

            navigator.clipboard.writeText(json).then(() => {
                showAlert('âœ… JSONã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼<br>Minecraftã§ <code>/kcdk config import &lt;JSON&gt;</code> ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„');
            }).catch(err => {
                showAlert('âŒ ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err, 'danger');
            });
        });

        // å…±æœ‰URLã‚³ãƒ”ãƒ¼
        document.getElementById('share-url').addEventListener('click', () => {
            const config = editor.getValue();
            const json = JSON.stringify(config);
            const url = `${window.location.origin}${window.location.pathname}?config=${encodeURIComponent(json)}`;

            navigator.clipboard.writeText(url).then(() => {
                showAlert('âœ… å…±æœ‰URLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
                // URLã‚’æ›´æ–°ï¼ˆãƒšãƒ¼ã‚¸ã¯ãƒªãƒ­ãƒ¼ãƒ‰ã—ãªã„ï¼‰
                window.history.pushState({}, '', url);
            }).catch(err => {
                showAlert('âŒ ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err, 'danger');
            });
        });

        // ãƒªã‚»ãƒƒãƒˆ
        document.getElementById('reset-config').addEventListener('click', () => {
            if (confirm('è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ')) {
                editor.setValue(defaultConfig);
                window.history.pushState({}, '', window.location.pathname);
                showAlert('ğŸ”„ è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã—ãŸ', 'info');
            }
        });
    </script>
</body>

</html>